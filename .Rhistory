setwd('/Users/catherinesmith/Desktop/unc_bootcamp/finalProject')
data <-read.csv('winequality-red.csv')
View(data)
data <-read.csv('winequality-red.csv', sep = ;)
data <-read.csv('winequality-red.csv', sep = ';')
View(data)
attach(data)
View(data)
model <- lm(quality ~ .)
detach(data)
model <- lm(data, quality ~ .)
View(data)
model <- lm(data, data$quality ~ .)
lm(quality ~ ., daat)
lm(quality ~ ., data)
# simple linear model
model<-lm(quality ~ ., data)
plot(model)
# diagnostic plots
par(mfrow=c(2,2))
plot(model)
# diagnostic plots
par(mfrow=c(2,2))
plot(model)
#scatter plot of each variable
pairs(~.,data=data,gap=0.4,cex.labels=1.5)
#scatter plot of each variable
pairs(~.,data=data,gap=0.4,cex.labels=1.5)
# simple linear model
model<-lm(quality ~ ., data)
model
summary(model)
lm(quality ~ volatile.acidity + alcohol)
lm(quality ~ volatile.acidity + alcohol, data)
lm(quality ~ volatile.acidity + alcohol, data) %>% summary()
library(tidyverse)
lm(quality ~ volatile.acidity + alcohol, data) %>% summary()
plot(lm(quality ~ volatile.acidity + alcohol, data) %>% summary())
plot(lm(quality ~ volatile.acidity + alcohol, data))
plot(lm(quality ~ volatile.acidity, data))
plot(lm(quality ~ location, data))
plot(lm(quality ~ alcohol, data))
# try a glm - poisson
glm(quality ~ alcohol, data=data, family = 'poisson')
# try a glm - poisson
glm(quality ~ alcohol, data=data, family = 'poisson') %>% summary()
# try a glm - poisson
model<-glm(quality ~ alcohol, data=data, family = 'poisson') %>% summary()
par(mfrow=c(2,2))
plot(model)
# try a glm - poisson
model<-glm(quality ~ alcohol, data=data, family = 'poisson') %>% summary()
par(mfrow=c(2,2))
plot(model)
# simple linear model
model<-lm(quality ~ ., data)
summary(model)
# diagnostic plots --> look very bad!
par(mfrow=c(2,2))
plot(model)
# try a glm - poisson
model<-lm(sqrt(quality) ~ sqrt(alcohol), data=data, family = 'poisson') %>% summary()
# try a glm - poisson
model<-lm(sqrt(quality) ~ sqrt(alcohol), data=data, family = 'poisson') %>% summary()
# try a glm - poisson
model<-lm(sqrt(quality) ~ sqrt(alcohol), data=data,) %>% summary()
par(mfrow=c(2,2))
plot(model)
# try a glm - poisson
model<-lm(sqrt(quality) ~ sqrt(alcohol), data=data,) %>% summary()
par(mfrow=c(2,2))
plot(model)
# try a glm - poisson
model <- lm(sqrt(quality) ~ sqrt(alcohol), data=data)
par(mfrow=c(2,2))
plot(model)
setwd('/Users/catherinesmith/Desktop/unc_bootcamp/finalProject')
library(tidyverse)
data <-read.csv('winequality-red.csv', sep = ';')
model <- lm(sqrt(quality) ~ sqrt(alcohol), data=data)
par(mfrow=c(2,2))
plot(model)
model<-lm(quality ~ ., data)
summary(model)
# diagnostic plots --> look very bad!
par(mfrow=c(2,2))
plot(model)
model <- lm(sqrt(quality) ~ sqrt(alcohol), data=data)
par(mfrow=c(2,2))
plot(model)
hatvalues(model)
leverage_cutoff <- 4/length(data$quality)
high_hat <- which(hatvalues(model) > leverage_cutoff)
length(high_hat)
data <- data[-high_hat,]
# try model without points of high leverage
model <- lm(sqrt(quality) ~ sqrt(alcohol), data=data)
par(mfrow=c(2,2))
plot(model)
high_hatt
high_hat
# simple linear model
model<-lm(quality ~ alcohol +
volatile.acidity+
sulphates+
citric.acid+
total.sulfur.dioxide, data)
summary(model)
# diagnostic plots --> look very bad!
par(mfrow=c(2,2))
plot(model)
installed.packages('boot')
install.packages('boot')
library(boot)
# try a glm - poisson
model <- glm(quality ~ alcohol, data=data, family='poisson')
par(mfrow=c(2,2))
glm.diag.plots(model, glm.diag(model) )
# remove points of high leverage
leverage_cutoff <- 4/length(data$quality)
high_hat <- which(hatvalues(model) > leverage_cutoff)
length(high_hat)
data <- data[-high_hat,]
# try model without points of high leverage
# model <- lm(sqrt(quality) ~ sqrt(alcohol), data=data)
model <- glm(quality ~ alcohol, data=data, family='poisson')
par(mfrow=c(2,2))
glm.diag.plots(model, glm.diag(model) )
setwd('/Users/catherinesmith/Desktop/unc_bootcamp/finalProject')
library(tidyverse)
library(boot)
data <-read.csv('winequality-red.csv', sep = ';')
leverage_cutoff <- 4/length(data$quality)
high_hat <- which(hatvalues(model) > leverage_cutoff)
data <- data[-high_hat,]
# remove points of high leverage
leverage_cutoff <- 4/length(data$quality)
high_hat <- which(hatvalues(model) > leverage_cutoff)
length(high_hat)
data <- data[-high_hat,]
setwd('/Users/catherinesmith/Desktop/unc_bootcamp/finalProject')
function (..., list = character(), package = NULL, lib.loc = NULL,
verbose = getOption("verbose"), envir = .GlobalEnv, overwrite = TRUE)
setwd('/Users/catherinesmith/Desktop/unc_bootcamp/finalProject')
library(tidyverse)
library(boot)
data <-read.csv('winequality-red.csv', sep = ';')
# remove points of high leverage
leverage_cutoff <- 4/length(data$quality)
high_hat <- which(hatvalues(model) > leverage_cutoff)
length(high_hat)
setwd('/Users/catherinesmith/Desktop/unc_bootcamp/finalProject')
library(tidyverse)
library(boot)
data <-read.csv('winequality-red.csv', sep = ';')
# simple linear model
model<-lm(quality ~ alcohol +
volatile.acidity+
sulphates+
citric.acid+
total.sulfur.dioxide, data)
# try model without points of high leverage
# model <- lm(sqrt(quality) ~ sqrt(alcohol), data=data)
# par(mfrow=c(2,2))
# plot(model)
model <- glm(quality ~ alcohol, data=data, family='poisson')
leverage_cutoff <- 4/length(data$quality)
high_hat <- which(hatvalues(model) > leverage_cutoff)
length(high_hat)
data <- data[-high_hat,]
par(mfrow=c(2,2))
glm.diag.plots(model, glm.diag(model) )
data <-read.csv('winequality-red.csv', sep = ';')
# try lasso
y <- data$quality
x<- data[,-data$quality]
View(x)
x<- data[,-y]
# try lasso
y <- data$quality
x<- data[,-y]
# try lasso
y <- data$quality
# try lasso
data <-read.csv('winequality-red.csv', sep = ';')
y <- data$quality
x<- data[,-y]
# try lasso
data <-read.csv('winequality-red.csv', sep = ';')
y <- data$quality
x<- data[,-c('quality')]
y <- data$quality
# try lasso
data <-read.csv('winequality-red.csv', sep = ';')
y <- data$quality
x<- data[,-c('quality')]
# try lasso
data <-read.csv('winequality-red.csv', sep = ';')
y <- data[,c(quality)]
# try lasso
data <-read.csv('winequality-red.csv', sep = ';')
y <- data[,c(quality)]
y <- data[,c('quality')]
x<- data[,-c('quality')]
x<- data[,!names(data) %in% y]
# try lasso
data <-read.csv('winequality-red.csv', sep = ';')
x<- data[,!names(data) %in% c('quality')]
# try lasso
data <-read.csv('winequality-red.csv', sep = ';')
y <- data$quality
x<- data[,!names(data) %in% c('quality')]
lasso = glmnet(x,y,alpha=1)
install.packages('glmnet')
library(glmnet)
lasso<- glmnet(x,y,alpha=1)
plot(lasso)
lambda_min <- lasso$lambda.min
lasso<- glmnet(x,y,alpha=1, lambda = lambda_min)
plot(lasso)
lasso<- glmnet(x,y,alpha=1)
lambda_min <- lasso$lambda.min
lasso<- glmnet(x,y,alpha=1, lambda = lambda_min)
plot(lasso)
lasso<- glmnet(x,y,alpha=1)
lambda_min <- lasso$lambda.min
lasso<- glmnet(x,y,alpha=1, lambda = lambda_min)
plot(lasso)
lasso<- cv.glmnet(x,y,alpha=1)
lambda_min <- lasso$lambda.min
lasso<- cv.glmnet(x,y,alpha=1, lambda = lambda_min)
plot(lasso)
library(glmnet)
# try lasso
data <-read.csv('winequality-red.csv', sep = ';')
y <- data$quality
x<- data[,!names(data) %in% c('quality')]
lasso<- cv.glmnet(x,y,alpha=1)
# try lasso
data <-read.csv('winequality-red.csv', sep = ';')
y <- data$quality
x<- data[,!names(data) %in% c('quality')]
lasso<- cv.glmnet(x,y,alpha=1)
